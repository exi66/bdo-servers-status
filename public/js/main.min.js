Chart.defaults.font.family="Arial";const updateChart=function(a,t,e){var r=getData(a);if(r.error)return console.error(r.error);var o=(r=r.filter((a=>a))).map((a=>({x:new Date(a.time),y:a.maintenance?null:-1==a.market?-10:a.market}))),n=r.map((a=>({x:new Date(a.time),y:a.maintenance?null:-1==a.auth?-10:a.auth}))),l=r.map((a=>({x:new Date(a.time),y:a.maintenance?null:-1==a.k1?-10:a.k1}))),s=r.map((a=>({x:new Date(a.time),y:a.maintenance?null:-1==a.v1?-10:a.v1}))),i=r.map((a=>({x:new Date(a.time),y:a.maintenance?null:-1==a.m1?-10:a.m1}))),c=r.map((a=>({x:new Date(a.time),y:a.maintenance?null:-1==a.kam1?-10:a.kam1})));switch(t){case"market":updateData(e,o,"Аукцион");break;case"auth":updateData(e,n,"Авторизация");break;case"k1":updateData(e,l,"Кальфеон-1");break;case"v1":updateData(e,s,"Валенсия-1");break;case"m1":updateData(e,i,"Медия-1");break;case"kam1":updateData(e,c,"Камасильвия-1");break;default:console.error("This data option not supported!")}},getData=function(a){try{var t=$.ajax({type:"GET",url:a,async:!1,cache:!1});return JSON.parse(t.responseText)}catch(a){return{error:a.message}}},createMonthChart=function(a){return new Chart(document.getElementById(a),{type:"bar",plugins:[{afterDraw:a=>{const t=a.ctx;t.save();const e=a.scales.x,r=a.scales.y.getPixelForValue(0);t.beginPath(),t.moveTo(e.left,r),t.lineTo(e.right,r),t.strokeStyle="rgba(255, 255, 255, 0.8)",t.stroke(),t.restore()}}],data:{datasets:[{label:"Авторизация",data:[{x:0,y:0}],backgroundColor:function(a){const t=a.dataIndex;return a.dataset.data[t].y<0?"rgba(220, 53, 69, 1)":"rgba(25, 135, 84, 1)"},borderColor:function(a,t){const e=t.color;return Chart.helpers.color(e).lighten(.2)},color:"rgba(255, 255, 255, 0.5)"}]},options:{elements:{point:{radius:0}},plugins:{legend:{labels:{color:"rgba(255, 255, 255, 0.5)",boxWidth:0}}},scales:{y:{grid:{color:"rgba(255, 255, 255, 0.3)",borderColor:"rgba(255, 255, 255, 0.3)"},color:"rgba(255, 255, 255, 0.5)",min:-10,suggestedMax:100,title:{color:"rgba(255, 255, 255, 0.5)",display:!0,text:"Задержка, ms"},ticks:{color:"rgba(255, 255, 255, 0.5)",callback:function(a,t){return a>=0?a:"down"}}},x:{ticks:{color:"rgba(255, 255, 255, 0.5)"},grid:{color:"rgba(255, 255, 255, 0.3)"},type:"time",time:{displayFormats:{hour:"HH:mm"},tooltipFormat:"dd.MM.yyyy",unit:"day",round:"day"}}}}})},createDayChart=function(a){return new Chart(document.getElementById(a),{type:"line",plugins:[{afterDraw:a=>{const t=a.ctx;t.save();const e=a.scales.x,r=a.scales.y.getPixelForValue(0);t.beginPath(),t.moveTo(e.left,r),t.lineTo(e.right,r),t.strokeStyle="rgba(255, 255, 255, 0.8)",t.stroke(),t.restore()}}],data:{datasets:[{spanGaps:!1,label:"Авторизация",data:[{x:0,y:0}],fill:{target:"origin",below:"rgba(220, 53, 69, 1)",above:"rgba(25, 135, 84, 1)"},borderWidth:0,backgroundColor:"rgba(25, 135, 84, 1)",color:"rgba(255, 255, 255, 0.5)"}]},options:{plugins:{legend:{labels:{color:"rgba(255, 255, 255, 0.5)",boxWidth:0}}},elements:{point:{radius:0}},scales:{y:{grid:{color:"rgba(255, 255, 255, 0.3)",borderColor:"rgba(255, 255, 255, 0.3)"},color:"rgba(255, 255, 255, 0.5)",stacked:!0,min:-10,suggestedMax:100,title:{color:"rgba(255, 255, 255, 0.5)",display:!0,text:"Задержка, ms"},ticks:{color:"rgba(255, 255, 255, 0.5)",callback:function(a,t){return a>=0?a:"down"}}},x:{ticks:{color:"rgba(255, 255, 255, 0.5)"},grid:{color:"rgba(255, 255, 255, 0.3)"},stacked:!0,type:"time",time:{displayFormats:{hour:"HH:mm"},tooltipFormat:"dd.MM.yyyy, HH:mm",unit:"hour",round:"minute"}}}}})},updateData=function(a,t,e){a.data.datasets[0].label=e,a.data.datasets[0].data=t,a.update()},removeData=function(a){a.data.labels.pop(),a.data.datasets.forEach((a=>{a.data.pop()})),a.update()},getUrlParameter=function(a){var t,e,r=window.location.search.substring(1).split("&");for(e=0;e<r.length;e++)if((t=r[e].split("="))[0]===a)return void 0===t[1]||decodeURIComponent(t[1]);return!1};
