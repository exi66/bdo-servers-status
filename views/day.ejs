<%- contentFor('body') %>
<main class="container mt-3">
  <div class="row">
    <div class="col-12 mb-3">
      <div class="row">
        <div class="col-12 col-lg-auto my-1">
          <div class="row">
            <div class="col-auto">
              <a class="btn btn-outline-light" href="/" role="button"><span class="d-none d-md-inline">Главная </span><i class="bi bi-house"></i></a>
            </div>
            <div class="col-auto ms-auto ms-lg-0">
              <a class="btn btn-outline-light" href="./" role="button">Этот месяц</a>
            </div>
          </div>
        </div>
        <div class="col-12 col-lg-auto my-1">
          <div class="row">
            <div class="col-6">
              <div class="btn-group" role="group">
                <input id="pick_date" class="btn btn-outline-light" type="date">
                <button id="navigate_to_date" type="button" class="btn btn-outline-light"><i class="bi bi-caret-right-fill"></i></button>
              </div>
            </div>
            <div class="col-auto ms-auto">
              <a class="btn btn-outline-light" href="<%-large_image-%>" role="button"><span class="d-none d-md-inline">Изображение </span><i class="bi bi-image"></i></a>
            </div>
          </div>
        </div>
        <div class="col-12 col-lg-auto mx-auto mx-lg-0 ms-lg-auto my-1">  
          <select class="form-select bg-dark text-white" id="select_data">
            <option value="auth" selected>Авторизация</option>
            <option value="market">Аукцион</option>
            <option value="k1">Кальфеон-1</option>
            <option value="v1">Валенсия-1</option>
            <option value="m1">Медия-1</option>
            <option value="kam1">Камасильвия-1</option>
          </select>
        </div>
        <div class="col-12">
          <canvas id="chart"></canvas>
        </div>
      </div>
    </div>
  </div>
</main>
<script>
document.addEventListener("DOMContentLoaded",(function(t){let e=window.location.pathname.toString().split("/");var a=`/chart/${e[2]}/${e[3]}/${e[4]}.json`,n=`${e[2]}-${("0"+e[3]).slice(-2)}-${("0"+e[4]).slice(-2)}`,i=createDayChart("chart"),o=getDatasets(a),c=getData("/api/stats"),l=$("#select_data").find(":selected").val();function r(){if(!o||!i)return;let t=o.find((t=>t.name==l));return t?updateData(i,t):console.error("This type of datasets not allowed!")}c&&o&&(c.sort((function(t,e){let a=new Date(t).getTime(),n=new Date(e).getTime();return a<n?-1:a>n?1:0})),$("#pick_date").attr("min",c[0]),$("#pick_date").attr("max",c.slice(-1)),$("#pick_date").attr("value",n),r(),$("#navigate_to_date").click((function(){let t=$("#pick_date").val();if(t){let e=new Date(t);confirm(`Вы хотите посмотреть подробную статистику от ${e.toLocaleDateString("ru-RU")}?`)&&(window.location.href=`/stats/${e.getFullYear()}/${e.getMonth()+1}/${e.getDate()}`)}})),$("#select_data").on("change",(function(){l=this.value,r()})))}));
</script>
<%- contentFor('meta') %>
<meta property="og:title" content="Статистика за день">
<meta property="og:description" content="Сервис по отслеживанию доступности серверов BDO RU. Подробная статистика за день/месяц.">
<meta property="og:type" content="website">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image:src" content="<%- large_image+'?_='+new Date().getTime() -%>">

<meta property="og:image" content="/favicon.png">
<meta property="og:image:type" content="image/png">
<meta property="og:image:width" content="128">
<meta property="og:image:height" content="128">
<%- contentFor('title') %>
Статистика за день
<%- contentFor('style') %>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
<%- contentFor('script') %>
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
<script src="/js/main.min.js"></script>
<script src="/js/dayChart.min.js"></script>
